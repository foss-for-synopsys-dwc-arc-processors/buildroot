From 2b53220b292ef5b494996836dccf7cbcb3986909 Mon Sep 17 00:00:00 2001
From: Eugeniy Paltsev <Eugeniy.Paltsev@synopsys.com>
Date: Tue, 19 Dec 2017 14:02:40 +0300
Subject: [PATCH 24/46] ARC: add invalidation of I$ and D$ to relocation helper

---
 arch/arc/lib/init_helpers.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/arch/arc/lib/init_helpers.c b/arch/arc/lib/init_helpers.c
index dbc8d68ffb..67cfeb1db9 100644
--- a/arch/arc/lib/init_helpers.c
+++ b/arch/arc/lib/init_helpers.c
@@ -10,8 +10,11 @@ DECLARE_GLOBAL_DATA_PTR;
 
 int init_cache_f_r(void)
 {
-#ifndef CONFIG_SYS_DCACHE_OFF
 	flush_dcache_all();
-#endif
+	invalidate_dcache_all();
+
+	/* Actually needed only in case of disabled dcache */
+	invalidate_icache_all();
+
 	return 0;
 }
-- 
2.11.0

