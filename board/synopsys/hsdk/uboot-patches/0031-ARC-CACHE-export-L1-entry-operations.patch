From 8c6fae617f8ca6523618e1eb557aac1f21f69787 Mon Sep 17 00:00:00 2001
From: Eugeniy Paltsev <Eugeniy.Paltsev@synopsys.com>
Date: Fri, 22 Dec 2017 13:50:01 +0300
Subject: [PATCH 31/46] ARC: CACHE: export L1 entry operations

NOTE: it should be rewrited

Signed-off-by: Eugeniy Paltsev <Eugeniy.Paltsev@synopsys.com>
---
 arch/arc/lib/cache.c | 28 ++++++++++++++++++++++++----
 1 file changed, 24 insertions(+), 4 deletions(-)

diff --git a/arch/arc/lib/cache.c b/arch/arc/lib/cache.c
index 05275e2bd8..83ffec728a 100644
--- a/arch/arc/lib/cache.c
+++ b/arch/arc/lib/cache.c
@@ -285,13 +285,18 @@ void icache_disable(void)
 			      IC_CTRL_CACHE_DISABLE);
 }
 
+/* IC supports only invalidation */
+static inline void __ic_entire_op(void)
+{
+	write_aux_reg(ARC_AUX_IC_IVIC, 1);
+	read_aux_reg(ARC_AUX_IC_CTRL);	/* blocks */
+}
+
 void invalidate_icache_all(void)
 {
 	/* Any write to IC_IVIC register triggers invalidation of entire I$ */
-	if (icache_status()) {
-		write_aux_reg(ARC_AUX_IC_IVIC, 1);
-		read_aux_reg(ARC_AUX_IC_CTRL);	/* blocks */
-	}
+	if (icache_status())
+		__ic_entire_op();
 
 #ifdef CONFIG_ISA_ARCV2
 	if (slc_exists)
@@ -478,3 +483,18 @@ void flush_dcache_all(void)
 		__slc_entire_op(OP_FLUSH);
 #endif
 }
+
+void __l1_dc_flush_all(void)
+{
+	__dc_entire_op(OP_FLUSH);
+}
+
+void __l1_dc_invalidate_all(void)
+{
+	__dc_entire_op(OP_INV);
+}
+
+void __l1_ic_invalidate_all(void)
+{
+	__ic_entire_op();
+}
-- 
2.11.0

